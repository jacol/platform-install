# <%= generated_by_babushka %> - DO NOT MODIFY MANUALLY - CHANGES WILL BE OVERWRITTEN

user  <%= passenger_default_user %> <%= passenger_default_user %>;
worker_processes  1;
error_log <%= log_path %>/error.log;
pid /var/run/nginx.pid;

events {
	worker_connections  1024;
}

http {
	passenger_default_user <%= passenger_default_user %>;
	passenger_root 		<%= passenger_root %>;
	passenger_ruby 		<%= passenger_ruby %>;

	include       		mime.types;
	default_type  		application/octet-stream;
	sendfile        	on;
	keepalive_timeout 65;

	gzip 					on;
	gzip_proxied	any;
	gzip_types		text/plain text/css application/x-javascript application/json image/*;

	server {
		listen						8088;
		server_name				localhost;
		root 							/var/www/root;
		error_log  				<%= log_path %>/ruby_error.log;
		access_log  			<%= log_path %>/ruby_access.log;
		passenger_enabled on;

		include 					/var/www/root/*/../nginx.conf;			# this includes all apps
		rack_env 					development;
	}

	server {
		listen 8000;
		# ssl                  on;
		# ssl_certificate      <%= nginx_prefix %>/ssl/certs/hotx.resfinity.com.crt;
		# ssl_certificate_key  <%= nginx_prefix %>/ssl/private/hotx.resfinity.com.key;
		location ~* /polaris2/ {
			include 						<%= nginx_prefix %>/conf/access-list;
			deny 								all;
			proxy_pass 					http://192.168.194.15:80;
			proxy_set_header 		Host $http_host;
			proxy_set_header 		X-Forwarded-For $remote_addr;
			access_log  				<%= log_path %>/polaris2_access.log;
			error_log       		<%= log_path %>/polaris2_error.log;
		}
	}
}
